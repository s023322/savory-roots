import{t as C,a as S,c as O}from"../chunks/CYoz0CFR.js";import{i as z}from"../chunks/2ZJDLcXJ.js";import{v as te,I as re,V as ne,Q as ae,p as N,as as oe,z as s,T as x,y as b,a as W,at as M,au as ie,f as X,D as l,av as V,c as L,r as j,s as U,t as le}from"../chunks/BH-x3xJj.js";import{e as se}from"../chunks/Dc8CBiT0.js";import{p as u,i as q}from"../chunks/qqA6fhLo.js";import{c as ce,o as F}from"../chunks/CAJhvfer.js";import"../chunks/BJBH5m3E.js";import{N as ue,G as fe}from"../chunks/DvnJObH8.js";import{b as de}from"../chunks/C0r3UhqY.js";import{g as ve}from"../chunks/DIcWehZj.js";function me(o,e,r,t,a){var f;te&&re();var n=(f=e.$$slots)==null?void 0:f[r],i=!1;n===!0&&(n=e.children,i=!0),n===void 0||n(o,i?()=>t:t)}function A(o,e,r){var t=ne(o,e);t&&t.set&&(o[e]=r,ae(()=>{o[e]=null}))}function pe(o){return function(...e){var r=e[0];return r.preventDefault(),o==null?void 0:o.apply(this,e)}}const he="pk_test_51OnOAzH4ceWkCZ13BXbBaxpkT8RSdA3CgH9yczcnwK5hCAXqm4o551aVupJla4LVXNRP8DlqSTMMYhMXNM7ujPyN00sR6BTImW";var J="https://js.stripe.com/v3",ge=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/;var ye=function(){for(var e=document.querySelectorAll('script[src^="'.concat(J,'"]')),r=0;r<e.length;r++){var t=e[r];if(ge.test(t.src))return t}return null},H=function(e){var r="",t=document.createElement("script");t.src="".concat(J).concat(r);var a=document.head||document.body;if(!a)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return a.appendChild(t),t},we=function(e,r){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"4.6.0",startTime:r})},T=null,B=null,D=null,be=function(e){return function(){e(new Error("Failed to load Stripe.js"))}},Se=function(e,r){return function(){window.Stripe?e(window.Stripe):r(new Error("Stripe.js not available"))}},_e=function(e){return T!==null?T:(T=new Promise(function(r,t){if(typeof window>"u"||typeof document>"u"){r(null);return}if(window.Stripe){r(window.Stripe);return}try{var a=ye();if(!(a&&e)){if(!a)a=H(e);else if(a&&D!==null&&B!==null){var n;a.removeEventListener("load",D),a.removeEventListener("error",B),(n=a.parentNode)===null||n===void 0||n.removeChild(a),a=H(e)}}D=Se(r,t),B=be(t),a.addEventListener("load",D),a.addEventListener("error",B)}catch(i){t(i);return}}),T.catch(function(r){return T=null,Promise.reject(r)}))},xe=function(e,r,t){if(e===null)return null;var a=e.apply(void 0,r);return we(a,t),a},k,K=!1,Y=function(){return k||(k=_e(null).catch(function(e){return k=null,Promise.reject(e)}),k)};Promise.resolve().then(function(){return Y()}).catch(function(o){K||console.warn(o)});var Pe=function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];K=!0;var a=Date.now();return Y().then(function(n){return xe(n,r,a)})};function Ee(o,e,r,t,a={}){const n=r.create(e,a);return n.mount(o),n.on("change",i=>t("change",i)),n.on("ready",i=>t("ready",i)),n.on("focus",i=>t("focus",i)),n.on("blur",i=>t("blur",i)),n.on("escape",i=>t("escape",i)),n.on("click",i=>t("click",i)),n.on("loaderror",i=>t("loaderror",i)),n.on("loaderstart",i=>t("loaderstart",i)),n.on("networkschange",i=>t("networkschange",i)),n}const Le=typeof window>"u";function je(o){if(!Le)return o.registerAppInfo({name:"svelte-stripe-js",url:"https://svelte-stripe-js.vercel.app"})}var Te=C("<div></div>");function ke(o,e){N(e,!1);let r,t=x();const a=ce(),{elements:n}=oe("stripe");let i=u(e,"options",8,void 0);F(()=>(r=Ee(s(t),"payment",n,a,i()),()=>r.destroy()));function f(){r.blur()}function h(){r.clear()}function m(){r.destroy()}function y(){r.focus()}z();var d=Te();return de(d,w=>b(t,w),()=>s(t)),S(o,d),A(e,"blur",f),A(e,"clear",h),A(e,"destroy",m),A(e,"focus",y),W({blur:f,clear:h,destroy:m,focus:y})}function Ce(o,e){N(e,!1);const r=x();let t=u(e,"stripe",8),a=u(e,"mode",8,void 0),n=u(e,"theme",8,"stripe"),i=u(e,"variables",24,()=>({})),f=u(e,"rules",24,()=>({})),h=u(e,"labels",8,"above"),m=u(e,"loader",8,"auto"),y=u(e,"fonts",24,()=>[]),d=u(e,"locale",8,"auto"),w=u(e,"currency",8,void 0),I=u(e,"amount",8,void 0),R=u(e,"clientSecret",8,void 0),v=u(e,"elements",12,null);M(()=>(l(n()),l(i()),l(f()),l(h())),()=>{b(r,{theme:n(),variables:i(),rules:f(),labels:h()})}),M(()=>(l(t()),l(v()),l(a()),l(w()),l(I()),s(r),l(R()),l(y()),l(m()),l(d()),V),()=>{t()&&!v()&&(v(t().elements({mode:a(),currency:w(),amount:I(),appearance:s(r),clientSecret:R(),fonts:y(),loader:m(),locale:d()})),je(t()),V("stripe",{stripe:t(),elements:v()}))}),M(()=>(l(v()),s(r),l(d())),()=>{v()&&v().update({appearance:s(r),locale:d()})}),ie(),z();var c=O(),p=X(c);{var G=g=>{var P=O(),E=X(P);me(E,e,"default",{}),S(g,P)};q(p,g=>{t()&&v()&&g(G)})}S(o,c),W()}var Ie=C('<div class="w-fit h-fit font-lato text-lg flex flex-row space-x-2"><h1 class="relative block w-fit h-fit animate-spin font-icons">progress_activity</h1><h1>Processing...</h1></div>'),Re=C('<form><!> <button class="w-fit mx-auto relative block mt-8"><!></button></form>'),Ae=C('<div class="w-fit h-fit font-lato text-lg flex flex-row space-x-2"><h1 class="relative block w-fit h-fit animate-spin font-icons">progress_activity</h1><h1>Loading...</h1></div>'),Be=C('<div class="z-50 fixed"><!></div> <div class="z-0 font-lato"><div class="mt-24 px-8 w-full max-w-7xl mx-auto"><!></div></div>',1);function Ue(o,e){N(e,!1);let r=x(null),t=x(null),a=x(),n=x(!1);F(async()=>{b(r,await Pe(he)),b(t,await i())});async function i(){const c=await fetch('/payment-intent?price="2000"',{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({})}),{clientSecret:p}=await c.json();return p}async function f(){if(s(n))return;b(n,!0);const c=await s(r).confirmPayment({elements:s(a),redirect:"if_required"});c.error?(c.error,b(n,!1)):ve("/order?status=complete")}z();var h=Be(),m=X(h),y=L(m);ue(y,{}),j(m);var d=U(m,2),w=L(d),I=L(w);{var R=c=>{Ce(c,{get stripe(){return s(r)},get clientSecret(){return s(t)},theme:"flat",fonts:[{family:"Lato",src:"url(https://fonts.gstatic.com/s/lato/v24/S6uyw4BMUTPHjxAwXjeu.woff2)"}],variables:{fontFamily:"Lato, system-ui, sans-serif",colorDanger:"#7b3306",fontSizeBase:"16px",colorPrimaryText:"white",colorText:"black",colorPrimary:"#e17100",colorBackground:"white",borderRadius:"8px"},get elements(){return s(a)},set elements(p){b(a,p)},children:(p,G)=>{var g=Re(),P=L(g);ke(P,{});var E=U(P,2),Q=L(E);{var Z=_=>{var ee=Ie();S(_,ee)},$=_=>{fe(_,{text:"Confirm and Pay",href:"",element:"div",padding:"4"})};q(Q,_=>{s(n)?_(Z):_($,!1)})}j(E),j(g),le(()=>E.disabled=s(n)),se("submit",g,pe(f)),S(p,g)},$$slots:{default:!0},$$legacy:!0})},v=c=>{var p=Ae();S(c,p)};q(I,c=>{s(t)?c(R):c(v,!1)})}j(w),j(d),S(o,h),W()}export{Ue as component};
